<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Performance Tuning · Vahana Documentation</title><meta name="title" content="Performance Tuning · Vahana Documentation"/><meta property="og:title" content="Performance Tuning · Vahana Documentation"/><meta property="twitter:title" content="Performance Tuning · Vahana Documentation"/><meta name="description" content="Documentation for Vahana Documentation."/><meta property="og:description" content="Documentation for Vahana Documentation."/><meta property="twitter:description" content="Documentation for Vahana Documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Vahana Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="tutorial1.html">First Steps</a></li><li><a class="tocitem" href="hegselmann.html">Utilizing Graphs.jl</a></li><li><a class="tocitem" href="predator.html">Adding Spatial Information</a></li></ul></li><li class="is-active"><a class="tocitem" href="performance.html">Performance Tuning</a><ul class="internal"><li><a class="tocitem" href="#Optional-Assertions"><span>Optional Assertions</span></a></li><li><a class="tocitem" href="#Type-Hints"><span>Type Hints</span></a></li><li><a class="tocitem" href="#Iterator-Versions-of-Edge-Functions"><span>Iterator Versions of Edge Functions</span></a></li></ul></li><li><a class="tocitem" href="parallel.html">Parallel Simulations</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="definition.html">Model Definition</a></li><li><a class="tocitem" href="initialization.html">Initialization</a></li><li><a class="tocitem" href="transition.html">Transition Function</a></li><li><a class="tocitem" href="global.html">Global Layer</a></li><li><a class="tocitem" href="raster.html">Raster</a></li><li><a class="tocitem" href="plots.html">Plots</a></li><li><a class="tocitem" href="hdf5.html">File storage</a></li><li><a class="tocitem" href="logging.html">Logging</a></li><li><a class="tocitem" href="config.html">Configuration</a></li><li><a class="tocitem" href="misc.html">Misc</a></li><li><a class="tocitem" href="apiindex.html">Index</a></li></ul></li><li><a class="tocitem" href="changelog.html">Change Log</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="performance.html">Performance Tuning</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="performance.html">Performance Tuning</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/s-fuerst/Vahana.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/s-fuerst/Vahana.jl/blob/8fcb84894c002c2f09d2d703a6172f19e63695c0/docs/src/performance.md" title="View source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Performance-Tuning"><a class="docs-heading-anchor" href="#Performance-Tuning">Performance Tuning</a><a id="Performance-Tuning-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Tuning" title="Permalink"></a></h1><p>This section provides some explanations on how to fine-tune the simulation performance.</p><p>These tips are specific to Vahana. Of course, all the generic performance tips, such as writing <code>type-stable</code> functions, still apply.</p><h2 id="Optional-Assertions"><a class="docs-heading-anchor" href="#Optional-Assertions">Optional Assertions</a><a id="Optional-Assertions-1"></a><a class="docs-heading-anchor-permalink" href="#Optional-Assertions" title="Permalink"></a></h2><p>Vahana includes some checks on the usage of the Vahana API that can impact runtime performance. For example, in <a href="transition.html#Vahana.agentstate"><code>agentstate</code></a>, there are checks to ensure that the specified agenttype matches the agent&#39;s ID. These assertions that could degrade performance can be disabled by calling <a href="config.html#Vahana.enable_asserts"><code>enable_asserts(false)</code></a>.</p><p>The recommended approach is to enable assertions during the model development phase but disable them when the model &quot;goes into production&quot;, such as before starting a parameter space exploration.</p><h2 id="Type-Hints"><a class="docs-heading-anchor" href="#Type-Hints">Type Hints</a><a id="Type-Hints-1"></a><a class="docs-heading-anchor-permalink" href="#Type-Hints" title="Permalink"></a></h2><p>It is possible to provide Vahana with hints about the types of agents or edges to improve the runtime performance and/or reduce memory requirements. You can use either hint independently or combine them as needed for your specific types.</p><p>Aside from the <code>:SingleEdge</code> hint, there is generally no requirement to modify the model code when a type hint is introduced to a type. The interface to Vahana remains consistent, with the restriction that certain functions may be unavailable. For instance, if the <code>:IgnoreFrom</code> hint is specified for an edge type, there is no <a href="transition.html#Vahana.edgestates"><code>edgestates</code></a> method available for this type, as Vahana has not retained the identifiers of neighboring entities and, consequently, cannot retrieve their corresponding states.</p><p>When implementing a model, it is a sensible approach to keep the assertions active and disregard hints. Upon completing the implementation, the next step should be to activated hints and evaluate their impact on performance. Subsequently, after selecting the best hint combination that does not trigger assertions, these can be deactivated as well.</p><h3 id="Agent-Hints"><a class="docs-heading-anchor" href="#Agent-Hints">Agent Hints</a><a id="Agent-Hints-1"></a><a class="docs-heading-anchor-permalink" href="#Agent-Hints" title="Permalink"></a></h3><p>Vahana supports two hints for agent types: <code>:Immortal</code> and <code>:Independent</code>. When an agent type is marked as <code>:Immortal</code>, it indicates that agents of this type will never be removed from the simulation. By default, Vahana assumes that agents can be removed (by returning nothing in a transition function). The <code>:Immortal</code> hint allows Vahana to skip certain checks and operations related to agent removal, potentially improving performance.</p><p>The <code>:Independent</code> hint indicates that agents of this type do not access the state of other agents of the same type during transition functions. This information allows Vahana to optimize memory usage and reduce unnecessary data copying.</p><h3 id="Edge-Hints"><a class="docs-heading-anchor" href="#Edge-Hints">Edge Hints</a><a id="Edge-Hints-1"></a><a class="docs-heading-anchor-permalink" href="#Edge-Hints" title="Permalink"></a></h3><p>Almost all hints can be combined in any way you prefer. For example, the combination of <code>:IgnoreFrom</code> and <code>:Stateless</code> may seem useless at first because no concrete edge information will be stored when <a href="initialization.html#Vahana.add_edge!"><code>add_edge!</code></a> is called. However, Vahana still keeps track of the number of edges that have the agent as the target node. This information alone, or combined with the <code>:SingleEdge</code> hint, can often be sufficient. You can refer to the <code>Die</code> or <code>Eat</code> edges in the <a href="predator.html">Predator example</a> for an illustration.</p><p>The only combination that is not allowed is <code>:SingleType</code> + <code>:SingleEdge</code>, unless you also set <code>:Stateless</code> and <code>:IgnoreFrom</code>.</p><p>Vahana supports five hints for edge types, which can be specified as optional arguments in the <a href="definition.html#Vahana.register_edgetype!"><code>register_edgetype!</code></a> function:</p><ul><li><code>:IgnoreFrom</code>: Excludes storage of the source node&#39;s ID.</li><li><code>:Stateless</code>: Stores only the source node&#39;s ID, omitting any additional state information.</li><li><code>:SingleType</code>: Indicates that all target nodes are of the same type, while source nodes can vary. This hint requires setting the target keyword (explained below).</li><li><code>:SingleEdge</code>: Specifies that each agent can be the target of at most one edge of this type. In the case that also the <code>:IgnoreFrom</code> and <code>:Stateless</code> hint are also set, multiple edges to an agent of this type can be created, but the only information available later is that at least one edge exists, as only the <a href="performance.html#Defined-Functions">has_edge</a> is defined.</li><li><code>:IgnoreSourceState</code>: Indicates that the source agent&#39;s ID is not used to access its state. This hint is particularly relevant for parallel simulations and is explained <a href="performance.html#:IgnoreSourceState">here</a>.</li></ul><p>These hints can be combined flexibly to suit your model&#39;s needs. For instance, combining <code>:IgnoreFrom</code> and <code>:Stateless</code> might seem redundant as it stores no explicit edge information when add_edge! is called. However, Vahana still maintains a count of edges targeting each agent per type. E.g. the Die and Eat edges in the <a href="performance.html">Adding Spatial Information tutorial</a> only needs the information that such an edge exists for an agent. Therefore for both types the <code>:IgnoreFrom</code>, <code>:Stateless</code> and <code>:SingleEdge</code> (or the <a href="performance.html#Special-Hint-Combinations"><code>:HasEdgeOnly</code></a>) hints could be set.</p><p>Most hint combinations are permissible, with one exception: :SingleType and :SingleEdge cannot be used together unless :Stateless and :IgnoreFrom are also specified.</p><h4 id=":SingleType-target-keyword-argument"><a class="docs-heading-anchor" href="#:SingleType-target-keyword-argument">:SingleType <code>target</code> keyword argument</a><a id=":SingleType-target-keyword-argument-1"></a><a class="docs-heading-anchor-permalink" href="#:SingleType-target-keyword-argument" title="Permalink"></a></h4><p>When the <code>:SingleType</code> hint is set, it is necessary to add the <code>target</code> keyword argument to the <a href="definition.html#Vahana.register_edgetype!"><code>register_edgetype!</code></a> function. The value of this argument should be the type of the target agents.</p><h4 id="Defined-Functions"><a class="docs-heading-anchor" href="#Defined-Functions">Defined Functions</a><a id="Defined-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Defined-Functions" title="Permalink"></a></h4><p>The following functions can be used to access the graph within <a href="transition.html#Vahana.apply!"><code>apply!</code></a>, but their availability depends on the edge type hints:</p><table><tr><th style="text-align: left">function</th><th style="text-align: left">not available for edge type with the hint (combination)</th></tr><tr><td style="text-align: left"><a href="transition.html#Vahana.edges"><code>edges</code></a></td><td style="text-align: left"><code>:IgnoreFrom</code> or <code>:Stateless</code></td></tr><tr><td style="text-align: left"><a href="transition.html#Vahana.neighborids"><code>neighborids</code></a></td><td style="text-align: left"><code>:IgnoreFrom</code></td></tr><tr><td style="text-align: left"><a href="transition.html#Vahana.neighborstates"><code>neighborstates</code></a></td><td style="text-align: left"><code>:IgnoreFrom</code></td></tr><tr><td style="text-align: left"><a href="transition.html#Vahana.edgestates"><code>edgestates</code></a>, <a href="global.html#Base.mapreduce"><code>mapreduce</code></a></td><td style="text-align: left"><code>:Stateless</code></td></tr><tr><td style="text-align: left"><a href="misc.html#Vahana.num_edges-Union{Tuple{T}, Tuple{Any, Type{T}}, Tuple{Any, Type{T}, Any}} where T"><code>num_edges</code></a></td><td style="text-align: left"><code>:SingleEdge</code></td></tr><tr><td style="text-align: left"><a href="transition.html#Vahana.has_edge"><code>has_edge</code></a></td><td style="text-align: left">always available</td></tr></table><p>As mentioned earlier, the Vahana API differs slightly when the <code>:SingleEdge</code> hint is set. This specifically affects the functions listed here, with the exception of <code>num_edges</code>, <code>has_edges</code>, and <code>mapreduce</code>. Normally, these functions return a vector containing edges, IDs, or states (or <code>nothing</code>). However, when used in combination with the <code>:SingleEdge</code> hint, they return only a single edge, ID, or state (or <code>nothing</code>), as the hint implies that there can be at most one edge of that type.</p><h4 id="Special-Hint-Combinations"><a class="docs-heading-anchor" href="#Special-Hint-Combinations">Special Hint Combinations</a><a id="Special-Hint-Combinations-1"></a><a class="docs-heading-anchor-permalink" href="#Special-Hint-Combinations" title="Permalink"></a></h4><p>Additionally, there are two property combinations that can be set in <a href="definition.html#Vahana.register_edgetype!"><code>register_edgetype!</code></a> using a single symbol, which directly expresses the intended combination:</p><ul><li><p><code>:NumEdgesOnly</code>: This corresponds to the combination of <code>:IgnoreFrom</code> and <code>:Stateless</code>. In this case, only the number of edges is counted, so only calls to <a href="misc.html#Vahana.num_edges-Union{Tuple{T}, Tuple{Any, Type{T}}, Tuple{Any, Type{T}, Any}} where T"><code>num_edges</code></a> and <a href="transition.html#Vahana.has_edge"><code>has_edge</code></a> are possible.</p></li><li><p><code>:HasEdgeOnly</code>: This corresponds to the combination of <code>:IgnoreFrom</code>, <code>:Stateless</code>, and <code>:SingleEdge</code>. In this case, only calls to <a href="transition.html#Vahana.has_edge"><code>has_edge</code></a> are possible.</p></li></ul><h2 id="Iterator-Versions-of-Edge-Functions"><a class="docs-heading-anchor" href="#Iterator-Versions-of-Edge-Functions">Iterator Versions of Edge Functions</a><a id="Iterator-Versions-of-Edge-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Iterator-Versions-of-Edge-Functions" title="Permalink"></a></h2><p>Vahana offers iterator versions of several functions used to access edge and neighbor information, including <a href="transition.html#Vahana.neighborids_iter"><code>neighborids_iter</code></a>, <a href="transition.html#Vahana.edgestates_iter"><code>edgestates_iter</code></a>, <a href="transition.html#Vahana.neighborstates_iter"><code>neighborstates_iter</code></a>, and <a href="transition.html#Vahana.neighborstates_flexible_iter"><code>neighborstates_flexible_iter</code></a>. </p><p>The iterator functions work similarly to their non-iterator counterparts but return an iterator instead of a vector. This approach can be more memory-efficient as it doesn&#39;t create a full vector in memory. Instead, values are computed on-demand, which can be faster if you don&#39;t need to process all elements. They work well with Julia&#39;s built-in functions like map, filter, and reduce, allowing for efficient chaining of operations.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="predator.html">« Adding Spatial Information</a><a class="docs-footer-nextpage" href="parallel.html">Parallel Simulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 31 July 2025 18:52">Thursday 31 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
